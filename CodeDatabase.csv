CODE LINE,DESCRIPTION,MALICIOUS REASONING,NOTES,SOURCE
.aws,Folder that stores Amazon Web Services credentials and other sensitive information,Access to this file allows threat actors to steal and use credentials for AWS development,Seen accessed for data exfiltration puropses,https://www.reversinglabs.com/blog/sentinelsneak-malicious-pypi-module-poses-as-security-sdk
.bash_history,Stores the history of all commands used on that device,Hackers can take a look at all commands ever run on the compromised system,Seen accessed for data exfiltration puropses,https://www.reversinglabs.com/blog/sentinelsneak-malicious-pypi-module-poses-as-security-sdk
.bat,Code may attempt to run a batch file,"Batch files are used to contain various commands, which can easily be used for malicious purposes",,https://research.checkpoint.com/2022/cloudguard-spectral-detects-several-malicious-packages-on-pypi-the-official-software-repository-for-python-developers/
.exe,Potentially runs an executable file,Malicious scripts often download and run separate executable files that are the actual payload of the malware,,
.gitConfig,Directory storing configuration settings for Git,Threat actors could read and tamper with the Git settings held within this directory,Seen accessed for data exfiltration puropses,https://www.reversinglabs.com/blog/sentinelsneak-malicious-pypi-module-poses-as-security-sdk
.id_rsa,Code may be looking for the device's private SSH key,"With access to the device's private key, threat actors can gain further unauthorised access or impersonate the device on other systems",,https://research.checkpoint.com/2022/cloudguard-spectral-detects-several-malicious-packages-on-pypi-the-official-software-repository-for-python-developers/
.kube,Directory holds configuration information for Kubernetes (K8s),Threat actors could read and tamper with Kubernetes settings held within this directory,Seen accessed for data exfiltration puropses,https://www.reversinglabs.com/blog/sentinelsneak-malicious-pypi-module-poses-as-security-sdk
.ssh,Code may be looking for the deivice's SSH configuration file,Access to the configuration file may allow the threat actors to modify it to grant unauthorised access,,https://research.checkpoint.com/2022/cloudguard-spectral-detects-several-malicious-packages-on-pypi-the-official-software-repository-for-python-developers/
/root,The directory holding data and information related to the Root user on Linux devices,"As the Root user has the highest level of privilages on a Unix system, access to data stored in the Root's directory can allow hackers to gain higher permissions or steal sensitive data",,https://www.reversinglabs.com/blog/sentinelsneak-malicious-pypi-module-poses-as-security-sdk
/User Data,"File holds data about a user, such a credentials","Threat actors could use this file to steal credentials, bank details, or whatever user information is interesting to them",Seen accessed for data exfiltration puropses,https://www.fortinet.com/blog/threat-research/supply-chain-attack-via-new-malicious-python-packages-by-malware-author-core1337
authorized_keys,The authorized_keys file in Linuz specifies the SSH keys that can be used for logging into specified user accounts,Threat actors can add their own SSH key to this file to allow for persistant access to the system,,https://blog.sonatype.com/malicious-aptx-python-package-drops-meterpreter-shell-deletes-netstat
b64encode,Encodes data - often used for obfsucation,Often used for obfsucation,,https://github.com/rsc-dev/pypi_malware/blob/master/malware/distrib/distrib-0.1/setup.py
base64,Encodes data to Base64,Often used for obfsucation,,https://github.com/rsc-dev/pypi_malware/blob/master/malware/distrib/distrib-0.1/setup.py
chmod,Used to changefile access permissions ,"By changing the access permissions on a file, hackers can permit themselves access to sensitive data held on the compromised system",,https://blog.sonatype.com/malicious-aptx-python-package-drops-meterpreter-shell-deletes-netstat
curl,Used to transfer data using URL syntax,Threat actors can use this to send or receive data from a URL,Allows for access to command-and-control (C2) servers,https://blog.sonatype.com/new-pymafka-malicious-package-drops-cobalt-strike-on-macos-windows-linux
discord.com,"If found within a URL, this may send data back to a Discord server","Links to Discord servers have often been seen to create webhooks, transfer data, or even just alert threat actors that a new victim has been established.",,https://research.checkpoint.com/2022/cloudguard-spectral-detects-several-malicious-packages-on-pypi-the-official-software-repository-for-python-developers/
encode,Encodes data - often used for obfsucation,"Encoded code and data is harder for users to read and understand, minimising the chances of detection",,https://github.com/rsc-dev/pypi_malware/blob/master/malware/distrib/distrib-0.1/setup.py
Invoke-WebRequest,A PowerShell command for getting content from a web page on the internet,Malicious scripts will often download their payload seperatley to minimise detection,FortiGuard Labs reserachers discovered this code being used to download malware: https://www.fortinet.com/blog/threat-research/supply-chain-attack-using-identical-pypi-packages-colorslib-httpslib-libhttps,https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/invoke-webrequest?view=powershell-7.3
netstat,"Netstat is a command line utility that displays TCP network connections, routing tables, and other networking information. This utility can help admins identify active connections",Code that tampers with the Netstat utility may be attempting to prevent administrators from discovering malicious connections made by hackers,,https://blog.sonatype.com/malicious-aptx-python-package-drops-meterpreter-shell-deletes-netstat
os.getenv(,Returns the value of the environment variable key if it exists,"Used by threat actors to access the directory that certain files or folders exist in, allowing them to exfiltrate data",Seen accessed for data exfiltration puropses,https://www.reversinglabs.com/blog/beware-impostor-http-libraries-lurk-on-pypi
os.remove(,Used to delete or remove a filepath,Hackers can remove certain utilities and files necessary to device security and admin functions with this function,https://www.geeksforgeeks.org/python-os-unlink-method/,https://blog.sonatype.com/malicious-aptx-python-package-drops-meterpreter-shell-deletes-netstat
os.unlink(,Used to delete or remove a filepath,Hackers can remove certain utilities and files necessary to device security and admin functions with this function,https://www.geeksforgeeks.org/python-os-unlink-method/,https://blog.sonatype.com/malicious-aptx-python-package-drops-meterpreter-shell-deletes-netstat
platform.system()==,Attempts to understand what system the code is running on,Allows threat actors to use malicious script that is tailoured to the platform the code is running on,,https://blog.sonatype.com/new-pymafka-malicious-package-drops-cobalt-strike-on-macos-windows-linux
powershell ,Runs a PowerShell command,Powershell is often used to run commands directly on the compromised machine,,
requests.post,makes a POST request to a web page,"Sends data back to the threat actor's server, such as harvested credentials",Has been used to alert threat actors that a new user has downloaded their malicious package. Source: https://research.checkpoint.com/2022/cloudguard-spectral-detects-several-malicious-packages-on-pypi-the-official-software-repository-for-python-developers/,https://research.checkpoint.com/2022/cloudguard-spectral-detects-several-malicious-packages-on-pypi-the-official-software-repository-for-python-developers/
urlopen,"Code requests data from URL, can be used to send data to a C2",Malicious scripts will often download their payload seperatley to minimise detection,,https://github.com/rsc-dev/pypi_malware/blob/master/malware/distrib/distrib-0.1/setup.py
webhook,"A HTTP-based callback function that assists with communication between two APIs, and are great for automatic data transfer and for sending small amounts of data.",Webhooks make it easier for threat actors to send data and communicate with the compromised system,,https://research.checkpoint.com/2022/cloudguard-spectral-detects-several-malicious-packages-on-pypi-the-official-software-repository-for-python-developers/
wget,Command used to retreive content from a web server,"Threat actors can use this to easily send or retreive data, and can allow them to easily download a malicious script or to send stolen information",,https://www.bleepingcomputer.com/news/security/241-npm-and-pypi-packages-caught-dropping-linux-cryptominers/
pip install,Used to install new Python libraries,The script may be attempting to download a malicious library without the user knowing,"Often seen in os.system() commands,it may be worth checking the library the program is trying to download! ",https://blog.cyble.com/2023/05/03/new-kekw-malware-variant-identified-in-pypi-package-distribution/
subprocess,"Allows a Python script to run another process, usually one involving a command-line argument or another script",Running a subprocess allows the script to invoke code without the user noticing.,,https://research.checkpoint.com/2022/cloudguard-spectral-detects-several-malicious-packages-on-pypi-the-official-software-repository-for-python-developers/
